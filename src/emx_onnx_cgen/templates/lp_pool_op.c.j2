static inline void {{ op_name }}({{ dim_args }}{{ params | join(', ') }}) {
    for (idx_t n = 0; n < {{ batch }}; ++n) {
        for (idx_t c = 0; c < {{ channels }}; ++c) {
            for (idx_t oh = 0; oh < {{ out_h }}; ++oh) {
                for (idx_t ow = 0; ow < {{ out_w }}; ++ow) {
                    {{ c_type }} acc = {{ zero_literal }};
                    const idx_t h_start = oh * {{ stride_h }} - {{ pad_top }};
                    const idx_t w_start = ow * {{ stride_w }} - {{ pad_left }};
                    for (idx_t kh = 0; kh < {{ kernel_h }}; ++kh) {
                        for (idx_t kw = 0; kw < {{ kernel_w }}; ++kw) {
                            const idx_t in_h = h_start + kh;
                            const idx_t in_w = w_start + kw;
                            if (in_h >= 0 && in_h < {{ in_h }} && in_w >= 0 && in_w < {{ in_w }}) {
                                {{ c_type }} value = {{ input0 }}[n][c][in_h][in_w];
                                acc += {{ pow_fn }}({{ abs_fn }}(value), ({{ c_type }}){{ p }});
                            }
                        }
                    }
                    {{ output }}[n][c][oh][ow] = {{ pow_fn }}(acc, ({{ c_type }})1.0 / ({{ c_type }}){{ p }});
                }
            }
        }
    }
}
