static inline void {{ op_name }}({{ dim_args }}{{ params | join(', ') }}) {
    const {{ c_type }} *input_data = (const {{ c_type }} *){{ input0 }};
    {{ c_type }} *output_ptrs[] = { {% for output in outputs %}({{ c_type }} *){{ output }}{% if not loop.last %}, {% endif %}{% endfor %} };
    const idx_t axis_sizes[] = { {% for axis in axis_sizes %}{{ axis }}{% if not loop.last %}, {% endif %}{% endfor %} };
    for (idx_t outer_idx = 0; outer_idx < {{ outer }}; ++outer_idx) {
        idx_t input_base = outer_idx * {{ axis_total }} * {{ inner }};
        idx_t axis_offset = 0;
        for (idx_t output_idx = 0; output_idx < {{ output_count }}; ++output_idx) {
            idx_t copy_elems = axis_sizes[output_idx] * {{ inner }};
            memcpy(
                output_ptrs[output_idx] + outer_idx * copy_elems,
                input_data + input_base + axis_offset,
                copy_elems * sizeof({{ c_type }})
            );
            axis_offset += copy_elems;
        }
    }
}
