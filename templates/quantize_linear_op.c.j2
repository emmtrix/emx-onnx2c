static inline void {{ op_name }}({{ dim_args }}{{ params | join(', ') }}) {
{% for dim in shape %}
for (idx_t {{ loop_vars[loop.index0] }} = 0; {{ loop_vars[loop.index0] }} < {{ dim }}; ++{{ loop_vars[loop.index0] }}) {
{% endfor %}
    {{ compute_type }} scaled = (({{ compute_type }}){{ input_expr }} / ({{ compute_type }}){{ scale_expr }}) + ({{ compute_type }}){{ zero_expr }};
    {{ compute_type }} rounded = {{ round_fn }}(scaled);
    if (rounded < ({{ compute_type }}){{ min_literal }}) {
        rounded = ({{ compute_type }}){{ min_literal }};
    }
    if (rounded > ({{ compute_type }}){{ max_literal }}) {
        rounded = ({{ compute_type }}){{ max_literal }};
    }
    {{ output_expr }} = ({{ output_c_type }})rounded;
{% for _ in shape %}
}
{% endfor %}
}
