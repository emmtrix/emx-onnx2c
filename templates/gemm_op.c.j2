static inline void {{ op_name }}({{ params | join(', ') }}) {
    for (size_t i = 0; i < {{ m }}; ++i) {
        for (size_t j = 0; j < {{ n }}; ++j) {
            {{ acc_type }} acc = {{ zero_literal }};
            for (size_t k = 0; k < {{ k }}; ++k) {
                {% if trans_a %}
                const {{ c_type }} a_val = {{ input_a }}[k][i];
                {% else %}
                const {{ c_type }} a_val = {{ input_a }}[i][k];
                {% endif %}
                {% if trans_b %}
                const {{ c_type }} b_val = {{ input_b }}[j][k];
                {% else %}
                const {{ c_type }} b_val = {{ input_b }}[k][j];
                {% endif %}
                acc += a_val * b_val;
            }
            {% if input_c %}
            {% if c_rank == 2 %}
            size_t c_i = {% if c_dim0 == 1 %}0{% else %}i{% endif %};
            size_t c_j = {% if c_dim1 == 1 %}0{% else %}j{% endif %};
            const {{ c_type }} bias = {{ input_c }}[c_i][c_j];
            {% elif c_rank == 1 %}
            size_t c_j = {% if c_dim1 == 1 %}0{% else %}j{% endif %};
            const {{ c_type }} bias = {{ input_c }}[c_j];
            {% else %}
            const {{ c_type }} bias = {{ input_c }}[0];
            {% endif %}
            {{ output }}[i][j] = acc * {{ alpha_literal }} + bias * {{ beta_literal }};
            {% else %}
            {{ output }}[i][j] = acc * {{ alpha_literal }};
            {% endif %}
        }
    }
}
